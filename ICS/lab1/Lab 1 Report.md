# Lab 1 Report

## 实验目的

* 使用LC3机器码编写程序：统计A的二进制表示低B位中1的个数

## 实验原理

* 统计二进制位中有多少个1，可以使用“二进制指针移位试探法”，即令一个16位的1不断左移，与原数按位与，如果结果不为0，则该位是1
* 有了这个基本思路，我们需要解决几个问题：
  * 指针的构造：使用二进制数1即可
  * 左移：即乘2，也就是自加，只需要使用ADD Rx, Rx, Rx类指令即可
  * 记录1的个数，使用一个寄存器，若按位与结果不为0，则自增1即可

## 实验过程

```bash 
0011 0000 0000 0000     ; start the program at location x3000
0010 000 011111111      ; LD R0, x3001 + 255
0010 001 011111111      ; LD R1, x3002 + 255
1110 010 011111111      ; LEA R2, x3102
0101 011 011 1 00000    ; AND R3, R3, #0
0001 011 011 1 00001    ; ADD R3, R3, #1
0101 111 111 1 00000    ; AND R7, R7, #0

0001 001 001 1 11111    ; ADD R1, R1, -1
0000 100 000000101      ; BRn #5
0101 101 000 0 00011    ; AND R5, R0, R3
0000 010 000000001      ; BRz #1
0001 111 111 1 00001    ; ADD R7, R7, #1
0001 011 011 0 00011    ; ADD R3, R3, R3
0000 111 111111001      ; BR #-8
0111 111 010 000000     ; STR R7, R2, #0

```

每一行代码的注释已经在代码中标出。

* 先将两个参数从内存中加载到R0和R1中，之后计算出需要存储的地址x3102存入R2。之后，将R3载入1，用作二进制指针，并用R7来记录1的个数
* 进入主体循环，使用R1作计数器，不断递减。如果R1已经小于0，那么跳出循环存储结果。否则执行循环体内指令。
* 在循环体内，首先将R0和R3按位与。如果结果为0，则跳过R7递增这行命令。通过这个循环，最终可以正确的统计出1的个数

## 实验结果

* 统计32767低15位中1的个数：

实验数据：

![image-20221107180139216](C:\Users\MAdrid\AppData\Roaming\Typora\typora-user-images\image-20221107180139216.png)

执行结果：

![image-20221107180211679](C:\Users\MAdrid\AppData\Roaming\Typora\typora-user-images\image-20221107180211679.png)

实验结果正确

* 统计75低10位中1的个数：

实验数据：

![image-20221107180344888](C:\Users\MAdrid\AppData\Roaming\Typora\typora-user-images\image-20221107180344888.png)

运行结果：

![image-20221107180415694](C:\Users\MAdrid\AppData\Roaming\Typora\typora-user-images\image-20221107180415694.png)

实验结果正确

